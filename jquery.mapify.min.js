!function(t,e,n,o){"use strict";var i="mapify",a=i+"ResizeDone",s={points:[],type:"roadmap",center:!1,zoom:!1,responsive:!1,key:!1,callback:!1},r={redraw:"drawMap",remove:"removeMap",destroy:"destroyMap"},p=!1,d=function(e,n){this.element=e,this.settings=t.extend({},s,n),this._defaults=s,this._name=i,this.init()};d.googleLoaded=!1,d.googleReady=function(){return"undefined"!=typeof google},d.until=function(t,e,n,o){if(t())return e();n=n||100,o=o||!1;var i=setInterval(function(){t()&&(e(),clearInterval(i))},n);if(o){setTimeout(function(){clearInterval(i)},o)}},d.prototype.init=function(){var e=this;e._style=t(e.element).attr("style"),e.getApi(function(){e.drawMap()})},d.prototype.getApi=function(e){var n="//maps.google.com/maps/api/js";return this.settings.key&&(n=n+"?key="+this.settings.key),d.googleReady()?e():(d.googleLoaded||(t.getScript(n),d.googleLoaded=!0),void d.until(d.googleReady,e,50,4e3))},d.prototype.mapType=function(){var t=this.settings.type,e=google.maps.MapTypeId;if(e.hasOwnProperty(t))return e[t];for(var n in e)if(e[n]===t)return t;return e.ROADMAP},d.prototype.addPoint=function(e){var n,o,i,a=this;return!(!e.lat||!e.lng)&&(n=new google.maps.LatLng({lat:e.lat,lng:e.lng}),a.bounds.extend(n),void(e.marker&&(o=new google.maps.Marker({map:a.map,position:n}),"string"===t.type(e.marker)&&o.setIcon(e.marker),e.title&&o.setTitle(e.title),e.infoWindow&&(i=new google.maps.InfoWindow({content:e.infoWindow}),o.addListener("click",function(){i.open(a.map,o)})))))},d.prototype.resetBounds=function(){var t=this,e=this.settings.center,n=this.settings.zoom;t.map.fitBounds(t.bounds),e.lat&&e.lng&&t.map.addListener("bounds_changed",function(){t.map.setCenter(e)}),n&&t.map.addListener("bounds_changed",function(){t._zoomSet||(t.map.setZoom(n),t._zoomSet=!0)})},d.prototype.drawMap=function(){var n=this;n._zoomSet=!1,n.map=new google.maps.Map(n.element,{mapTypeId:n.mapType()}),n.bounds=new google.maps.LatLngBounds,t.each(n.settings.points,function(t,e){n.addPoint(e)}),n.resetBounds(),n.settings.responsive&&t(e).on(a,function(){n._zoomSet=!1,n.resetBounds()}),n.settings.callback&&n.settings.callback(n.map,n.bounds,n.settings)},d.prototype.removeMap=function(){t(this.element).empty().attr("style",this._style)},d.prototype.destroyMap=function(){this.removeMap(),t.removeData(this.element,i)},t.fn[i]=function(e){var n=this,o=[];return"instance"===e?(n.each(function(){o.push(t.data(this,i))}),1===o.length?o[0]:o):(n.each(function(){var n=t.data(this,i);return"string"===t.type(e)?"undefined"!=typeof n&&"undefined"!=typeof r[e]&&n[r[e]]():void(t.data(this,i)||t.data(this,i,new d(this,e)))}),n)},t(e).on("resize",function(){clearTimeout(p),p=setTimeout(function(){t(e).trigger(a)},100)})}(jQuery,window,document);